#!/bin/bash

# Checks if either configuration or deployment repositories has remote changes,
# then call im-restart to apply any changes

cd configuration
git remote update
GIT_STATUS_OUTPUT=$(git status)
cd ..

if [[ $GIT_STATUS_OUTPUT == *branch is behind* ]]
then
  nohup ./im-restart &
  exit
fi

cd deployment
git remote update
GIT_STATUS_OUTPUT=$(git status)
cd ..

if [[ $GIT_STATUS_OUTPUT == *branch is behind* ]]
then
  nohup ./im-restart &
  exit
fi

#!/bin/bash

trap : SIGTERM SIGINT

DEFAULT_INTEVAL_SECONDS=15
INTERVAL_SECONDS=${WATCH_INTERVAL:-$DEFAULT_INTEVAL_SECONDS}

watch -n $INTERVAL_SECONDS ./im-check &

WATCH_PID=$!
wait $WATCH_PID
if [[ $? -gt 128 ]]
then
  kill $WATCH_PID
fi

